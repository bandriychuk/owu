<!DOCTYPE html>
<html lang="uk">
<head>
	<meta charset="UTF-8">
	<title>Title</title>
</head>
<body>

<script>

	//callback hell
	// fetch('https://jsonplaceholder.typicode.com/users/1')
	// 	.then(response => response.json())
	// 	.then(users => {
	// 		//отримання всіх постів певного користувача
	// 		fetch('https://jsonplaceholder.typicode.com/posts?userId=' + users.id)
	// 			.then(response => response.json())
	// 			.then(posts => {
	// 				//витягнули перший пост
	// 				let post = posts[0];
	// 				// отримали всі коментарі до поста
	// 				fetch('https://jsonplaceholder.typicode.com/comments?postId=' + post.id)
	// 					.then(response => response.json())
	// 					.then(comments => {
	// 						console.log(comments);
	// 					});
	// 			});
	// 	});

	// Promise - спеціальна обгортка для обробки асинхронних операцій

	// fetch('https://jsonplaceholder.typicode.com/users/1')
	// 	.then(response => response.json())
	// 	.then(user => {
	// 		return fetch('https://jsonplaceholder.typicode.com/posts?userId=' + users.id)
	// 			.then(value => value.json())
	// 			.then(value => {
	// 				console.log(value);
	// 				return value;
	// 			});
	// 	})
	// 	.then(posts => {
	// 		return fetch('https://jsonplaceholder.typicode.com/comments?postId=' + post.id)
	// 			.then(value => value.json())
	// 			.then(comments => {
	// 				return comments;
	// 			});
	// 	});

	// fetch('https://jsonplaceholder.typicode.com/users/1')
	// 	.then(response => response.json())
	// 	.then(user => fetch('https://jsonplaceholder.typicode.com/posts?userId=' + user.id))
	// 	.then(response => response.json())
	// 	.then(posts => fetch('https://jsonplaceholder.typicode.com/comments?postId=' + posts[0].id))
	// 	.then(response => response.json())
	// 	.then(commetns => console.log(commetns));

	// setTimeout(() => {
	// 	console.log('h');
	// 	setTimeout(() => {
	// 		console.log('e');
	// 		setTimeout(() => {
	// 			console.log('l');
	// 			setTimeout(() => {
	// 				console.log('l');
	// 				setTimeout(() => {
	// 					console.log('o');
	// 				}, 1000);
	// 			}, 1000);
	// 		}, 1000);
	// 	}, 1000);
	// }, 1000);

	// Promise - спеціальна обгортка для обробки асинхронних операцій

	// function promiseFn(letter) {
	// 	return new Promise(resolve => {
	// 		setTimeout(() => {
	// 			resolve(letter);
	// 		}, 1000);
	// 	});
	// }

	// new Promise(resolve => {
	// 	setTimeout(() => {
	// 		resolve('h');
	// 	}, 1000);
	// })
	// 	.then(value => {
	// 		console.log(value);
	// 		return new Promise(resolve => {
	// 			setTimeout(() => {
	// 				resolve('e');
	// 				//resolve - завжди дозволяє повернути свої данні в наступний then();
	// 			}, 1000);
	// 		});
	// 	})
	//
	// 	.then(value => {
	// 		console.log(value);
	// 		return new Promise(resolve => {
	// 			setTimeout(() => {
	// 				resolve('l');
	// 			}, 1000);
	// 		});
	// 	})
	// 	.then(value => {
	// 		console.log(value);
	// 		return new Promise(resolve => {
	// 			setTimeout(() => {
	// 				resolve('l');
	// 			},1000);
	// 		});
	// 	})
	// 	.then(value => console.log(value));

	// new Promise(resolve => {
	// 	setTimeout(() => {
	// 		resolve('h');
	// 	}, 1000);
	// })
	// 	.then(value => {
	// 		console.log(value);
	// 		return promiseFn('e');
	// 	})
	//
	// 	.then(value => {
	// 		console.log(value);
	// 		return promiseFn('l');
	// 	})
	// 	.then(value => {
	// 		console.log(value);
	// 		return promiseFn('l');
	// 	})
	// 	.then(value => {
	// 		console.log(value);
	// 		return promiseFn('o');
	// 	})
	// 	.then(value => console.log(value));

	// fetch('https://jsonplaceholder.typicode.com/users/1')
	// 	.then(response => response.json())
	// 	.then(user => fetch('https://jsonplaceholder.typicode.com/posts?userId=' + user.id))
	// 	.then(response => response.json())
	// 	.then(posts => fetch('https://jsonplaceholder.typicode.com/comments?postId=' + posts[0].id))
	// 	.then(response => response.json())
	// 	.then(commetns => console.log(commetns));

	//асинхронність  (приклад)

	// async function foobar() {
	// 	let user = await fetch('https://jsonplaceholder.typicode.com/users/1').then(value => value.json());
	// 	let posts = await fetch('https://jsonplaceholder.typicode.com/posts?postId=' + user.id)
	// 		.then(value => value.json());
	// 	let comments = await fetch('https://jsonplaceholder.typicode.com/comments?postId=' + posts[0].id)
	// 		.then(value => value.json());
	// 	console.log(comments);
	// }

	// foobar();

	//Promise приклад
	function fetchUsers() {
		return fetch('https://jsonplaceholder.typicode.com/users')
			.then(value => value.json())
			.then(value => {
				return value;
			});
	}


	function fetchPosts() {
		return fetch('https://jsonplaceholder.typicode.com/posts')
			.then(value => value.json())
			.then(value => {
				return value;
			});
	}


	function fetchComments() {
		return fetch('https://jsonplaceholder.typicode.com/comments')
			.then(value => value.json())
			.then(value => {
				return value;
			});
	}


	// Promise.all - (Повертає масив для більше ніж 1 елемент)
	// робить асинхронні запити в необмеженій кількості
	// або в залежності від переданих значень і виконує їх всіх.
	// Очікує коли відпрацюють всі асихронні функції.
	// Потім відпрацьовує сам Promise.all;
	//

	// let promise = Promise.all([fetchUsers(), fetchPosts(), fetchComments()]);
	// promise.then(value => {
	// 	console.log(value[0]);
	// 	console.log(value[1]);
	// 	console.log(value[2]);
	// });

	// let promise = Promise.all([fetchUsers(), fetchPosts()]);
	// promise.then(value => {
	// 	console.log(value[0]);
	// 	console.log(value[1]);
	// });

	// Promise.race - передаєтсья масив із запитів
	// Виводить той, хто виконується швидше;
	// поверне лиш одне значення, яке виконається найшвидше

	// Promise.race([fetchUsers(), fetchPosts()]).then(value => console.log(value));


</script>

</body>
</html>